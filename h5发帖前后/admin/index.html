<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>梦回后台</title>
    <link rel="stylesheet" type="text/css" href="css/style.css"/>
</head>
    
<body>
    <div id="datauppage">
        <span class="uptextbtn">点击上传文本：</span><input type="file" id="uptext" accept="text/*" >  <br>
        <span class="upimgbtn">点击上传图片：</span><input type="file" id="upimg"  accept="image/gif,image/png,image/jpeg"> <br />
        <input type="button" class="upbtn1" value="点击查看" id="chakan"> <input type="button" class="upbtn1" value="点击保存" id="baocun"><input type="button" value="取消" class="upbtn2" id="giveup">
    </div>
    <div id="sstext"></div>
    <div id="ssimg"></div>
</body>
<script type="text/javascript">
	var upimg=document.getElementById("upimg");
	var uptext=document.getElementById("uptext");
	var sstext=document.getElementById("sstext");
	var ssimg=document.getElementById("ssimg");
	var chakan=document.getElementById("chakan");
	var baocun=document.getElementById("baocun");
	chakan.onclick=function(){
		readAsDataURL();
		readAsText();
	}
	//保存数据
	baocun.onclick=function() {		
		if(ssimg.innerHTML.length>0 && sstext.innerHTML.length>0){
			window.localStorage.setItem(ssimg.innerHTML, sstext.innerHTML);
			var a=confirm("保存成功，点击确认进入首页，点击取消继续编辑");
			if(a==true){
				window.location.href="../index.html"
			}else{
				alert("请继续编辑");
			}
		}else{
			alert("请添加图片或文本");
		}
		
    }

	//上传文本时
	uptext.onchange=function(){
        var filetext=uptext.files[0];
        var reader =new FileReader();
        reader.readAsText(filetext);
	    reader.onload=function(e){
			var textData = this.result;
			sstext.innerHTML = textData;
	    }
	   }
	//上传图片时
	upimg.onchange=function(){
        var fileimg=upimg.files[0];
        var reader =new FileReader();
        reader.readAsDataURL(fileimg);
	    reader.onload=function(e){
			var urlData = this.result;
			ssimg.innerHTML='<img src="'+urlData+'"+alt="">';
	    }
	   }
</script>
</html>